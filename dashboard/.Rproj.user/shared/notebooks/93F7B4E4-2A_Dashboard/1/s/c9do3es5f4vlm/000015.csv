"0","# Apply the Kriging weights to the known data values at the sample locations"
"0",""
"0","f.vgram <- automap::autofitVariogram(NO2 ~ 1, input_data = as(no2_sf,"
"0","""Spatial"")) "
"0","no2_sp <- as(no2_sf, ""Spatial"")"
"0","# Convert the prediction grid to Spatial object"
"0","pred_grid <- as(pred_locations, ""Spatial"")"
"0",""
"0","k.samp <- gstat(formula = NO2 ~ 1, data = no2_sp, model = f.vgram$var_model)"
"0",""
"0","# Interpolating the surface using the fitted variogram."
"0","krige.pred <- predict(k.samp, newdata = pred_grid)"
"1","[using ordinary kriging]
"
"0","# Convert the prediction back to sf for easier plotting with ggplot2"
"0","krige.pred_sf <- st_as_sf(krige.pred)"
"0","# Plot the predictions"
"0","p5 <- ggplot(krige.pred_sf) +"
"0","geom_sf(aes(color = var1.pred)) +"
"0","scale_color_viridis(option = ""A"") +"
"0","theme_bw() +"
"0","labs(title = ""Interpolated Surface"", y = ""Latitude"", x = ""Longitude"","
"0","     color =""NO2"")"
"0","p5"
